{"version":3,"sources":["meteor://ðŸ’»app/client/templates/work/new.js"],"names":[],"mappings":"yBAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G","file":"/client/templates/work/new.js","sourcesContent":["\"use strict\";\n/*global $ : false */\n/*global Shops : false */\n/*global Meteor : false */\n/*global Router : false */\n/*global moment : false */\n/*global Session : false */\n/*global console : false */\n/*global Template : false */\n\nTemplate[\"work-new\"].rendered = function(){\n\tSession.set(Meteor.ADD_MODULE, true);\n};\n\nTemplate[\"work-new\"].destroyed = function(){\n\tSession.set(Meteor.ADD_MODULE, false);\n};\n\nTemplate[\"work-new\"].helpers({\n\trendezvous : function(){\n\t\tif(this.hash === \"installation\" ) return true;\n\t\treturn false;\n\t},\n\tplanner : function(){\n\t\tif(this.hash === \"maintenance\" ) return true;\n\t\treturn false;\n\t},\n\tworker : function(){\n\t\tif(this.hash === \"dÃ©pannage\" ) return true;\n\t\treturn false;\n\t},\n\tshop : function(){\n\t\tif(Session.get(Meteor.SHOP_ID)){\n\t\t\treturn Shops.findOne(Session.get(Meteor.SHOP_ID));\n\t\t}\n\t}\n});\n\nTemplate[\"work-new\"].events({\n\t\"click .workSave\" : function(event, template){\n\n\t\t$.when(\n\t\t\tTemplate.shopselector.shop(template, function(error){\n\t\t\t\tif(error) return console.log(error);\n\t\t\t}),\n\n\t\t\tTemplate.rdvPicker.date(template, function(error){\n\t\t\t\tif(error) return console.log(error);\n\t\t\t}),\n\n\t\t\tTemplate.rdvPlanner.dates(template, function(error){\n\t\t\t\tif(error) return console.log(error);\n\t\t\t}),\n\n\t\t\tTemplate.workerselector.workers(template, function(error){\n\t\t\t\tif(error) return console.log(error);\n\t\t\t})\n\t\t)\n\t\t.done(function(shop, rdvPicker, rdvPlanner, workers){\n\t\t\tvar rdv = rdvPicker ? rdvPicker : rdvPlanner;\n\t\t\trdv = rdv || moment().toISOString();\n\t\t\tSession.set(Meteor.WIKI_CURRENT_KEY, false);\n\n\t\t\tvar modules = Template.workmodule.modules();\n\n\t\t\tMeteor.call(\"workCreator\", shop, template.find(\"#workType\").value, rdv, workers, modules, function(error, workId){\n\t\t\t\tif(error) return console.log(error);\n\t\t\t\tRouter.go(\"work.show\", {workId : workId});\n\t\t\t});\n\t\t});\n\t\treturn false;\n\n\t}\n});"]}