{"version":3,"sources":["meteor://ðŸ’»app/client/templates/shop/form.js"],"names":[],"mappings":"yBAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G","file":"/client/templates/shop/form.js","sourcesContent":["\"use strict\";\n/*global $ : false */\n/*global _ : false */\n/*global Meteor : false */\n/*global Template : false */\n/*global Session : false */\n/*global Router : false */\n\n\nTemplate.shopform.destroyed = function(){\n\tSession.set(Meteor.CONTACT_LIST , [\"\"]);\n};\nTemplate.shopform.helpers({\n\tcontacts : function(){\n\t\treturn ((this.shop && this.shop.contacts)||[]).concat(Session.get(Meteor.CONTACT_LIST));\n\t}\t\n});\n\nTemplate.shopform.events({\n\t\"click .addContact\" : function(){\n\t\tSession.set(Meteor.CONTACT_LIST, Session.get(Meteor.CONTACT_LIST).concat([\"\"]));\n\t\treturn false;\n\t},\n\t\"blur input#tva\" : function(event, template){\n\t\tvar TVA = $(event.target).val();\n\t\tif(TVA){\n\t\t\tMeteor.call(\"checkTVA\", TVA, function(error, data){\n\t\t\t\tif(error)console.log(error);\n\t\t\t\ttemplate.find(\"#tva\").value = data.TVA.toLowerCase();\n\t\t\t\ttemplate.find(\"#name\").value = data.name.toLowerCase();\n\t\t\t\ttemplate.find(\"#address_street\").value = data.address.street.toLowerCase();\n\t\t\t\ttemplate.find(\"#address_number\").value = data.address.number.toLowerCase();\n\t\t\t\ttemplate.find(\"#address_city\").value = data.address.city.toLowerCase();\n\t\t\t\ttemplate.find(\"#address_zipcode\").value = data.address.zipcode.toLowerCase();\n\t\t\t});\n\t\t}\n\t},\n\t\"click button[type='submit']\" : function(event, template){\n\t\t\n\t\tvar button = template.find(\"button[type='submit']\");\n\t\tvar errors = template.find(\".has-error\");\n\t\tvar _id = template.find(\"#_id\");\n\t\tvar tva = template.find(\"#tva\");\n\t\tvar brand = template.find(\"#brand\");\n\t\tvar name = template.find(\"#name\");\n\t\tvar address_street = template.find(\"#address_street\");\n\t\tvar address_number = template.find(\"#address_number\");\n\t\tvar address_zipcode = template.find(\"#address_zipcode\");\n\t\tvar address_city = template.find(\"#address_city\");\n\t\tvar contacts = template.findAll(\"[name='contact']\");\n\t\t\n\t\t$(errors)\n\t\t.removeClass(\"has-error\");\n\n\t\tvar data = {\n\t\t\ttva : tva.value.toLowerCase(),\n\t\t\tbrand : brand.value.toLowerCase(),\n\t\t\tname : name.value.toLowerCase(),\n\t\t\taddress : {\n\t\t\t\tstreet : address_street.value.toLowerCase(),\n\t\t\t\tnumber : address_number.value.toLowerCase(),\n\t\t\t\tzipcode : address_zipcode.value.toLowerCase(),\n\t\t\t\tcity : address_city.value.toLowerCase()\n\t\t\t},\n\t\t\tcontacts : \t_\n\t\t\t\t\t\t.without(\tcontacts\n\t\t\t\t\t\t\t\t\t.map(function(contact){\n\t\t\t\t\t\t\t\t\t\treturn contact.value.toLowerCase();\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\"\", \n\t\t\t\t\t\t\t\t\tnull, \n\t\t\t\t\t\t\t\t\tundefined\n\t\t\t\t\t\t)\n\t\t};\n\t\tvar next = function(error){\n\t\t\tif(error){\n\t\t\t\tconsole.log(error);\n\t\t\t}\n\t\t\telse{\n\t\t\t\t$(button)\n\t\t\t\t.removeClass(\"btn-primary\")\n\t\t\t\t.addClass(\"btn-success\");\n\t\t\t\tRouter.go(\"shop.index\");\n\t\t\t}\n\t\t};\n\n\t\tif(_id.value){\n\t\t\tMeteor.call(\"shopUpdator\", _id.value, data, \"button[type='submit']\", next);\n\t\t}else{\n\t\t\tMeteor.call(\"shopCreator\", data, \"button[type='submit']\", next);\t\n\t\t}\n\t\t\n\n\t\treturn false;\n\n\t}\n});"]}