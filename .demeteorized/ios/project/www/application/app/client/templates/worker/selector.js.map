{"version":3,"sources":["meteor://ðŸ’»app/client/templates/worker/selector.js"],"names":[],"mappings":"yBAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,E","file":"/client/templates/worker/selector.js","sourcesContent":["\"use strict\";\n/*global $ : false */\n/*global Meteor : false */\n/*global Workers : false */\n/*global Template : false */\n\nvar getWorkers = function(notPickable){\n\tnotPickable = notPickable||[];\n\tvar workers = \tWorkers\n\t\t\t\t\t.find({\n\t\t\t\t\t\t_id : {\n\t\t\t\t\t\t\t$nin : notPickable\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.fetch()\n\t\t\t\t\t.map(function(worker){\n\t\t\t\t\t\tif(worker.profile){\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tlabel: worker.profile.firstname + \" \" + worker.profile.lastname, \n\t\t\t\t\t\t\t\tvalue: worker._id\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tlabel: \"noName\", \n\t\t\t\t\t\t\t\tvalue: worker._id\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\treturn workers.length ? workers : false;\n};\nvar initSelector = function(workers, autoAdd){\n\tvar workId = $(\"#workers\").parents(\"[data-work-id]\").first().attr(\"data-work-id\");\n\t$(\"#workers\")\n\t.multiselect({\n\t\tbuttonWidth: \"100%\", \n\t\tincludeSelectAllOption: true,\n\t\tallSelectedText: \"Tout le monde\",\n\t\tselectAllText : \"Tout le monde\",\n\t\tnonSelectedText : \"Aucun Homme\",\n\t\tonChange: function(option, checked) {\n\t\t\tif(checked){\n\t\t\t\tif(autoAdd){\n\t\t\t\t\tMeteor.call(\"workAddWorker\", workId, $(\"#workers\").val());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t})\n\t.multiselect(\"dataprovider\", workers);\n};\n\nTemplate.workerselector.helpers({\n\tworkers : function(){\n\t\treturn getWorkers(this.notPickable);\n\t},\n\tinitMultiselector : function(){\n\t\treturn initSelector(getWorkers(this.notPickable), this.autoAdd);\n\t}\n});\n\nTemplate.workerselector.rendered = function(){\n\treturn initSelector(getWorkers(this.data.notPickable), this.data.autoAdd);\n};\n\nTemplate.workerselector.workers = function(template, next){\n\tvar deferred = new $.Deferred();\n\tvalidator(template, function(error, values){\n\t\tif(error) {\n\t\t\tdeferred.reject(error);\n\t\t\treturn next(error);\n\t\t}\n\t\tdeferred.resolve(values||null);\n\t\treturn next(null, values||null);\n\t});\n\treturn deferred;\n};\n\nvar validator = function(template, next){\n\tvar workers = template.find(\"#workers\");\n\tvar errors = template.find(\".worker .has-error\");\n\t\n\t$(errors)\n\t.removeClass(\"has-error\");\n\n\tvar validation = function(element){\n\t\t\n\t\treturn false;\n\t};\n\tif(workers){\n\t\tif(\tvalidation(workers)){\n\t\t\treturn next(new Meteor.Error(\"validation-error\"));\n\t\t}\n\t\treturn next(null, $(workers).val());\n\t}\n\telse{\n\t\treturn next(null, null);\n\t}\n};"]}