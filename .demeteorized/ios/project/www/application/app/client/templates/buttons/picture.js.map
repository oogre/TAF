{"version":3,"sources":["meteor://ðŸ’»app/client/templates/buttons/picture.js"],"names":[],"mappings":"yBAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"/client/templates/buttons/picture.js","sourcesContent":["\"use strict\";\n/*global $ : false */\n/*global Meteor : false */\n/*global Template : false */\n/*global MeteorCamera : false */\n\nTemplate.buttonpicture.events({\n\t\"click button.photoShoot\": function () {\n\t\tvar selector = this.selector;\n\t\t\n\t\tif(!(selector && selector)){\n\t\t\treturn false;\n\t\t}\n\t\tMeteorCamera.getPicture({quality : 100}, function (error, data) {\n\t\t\tif(error) throw new Meteor.Error(error);\n\t\t\tuploadImage(data, selector);\n\t\t});\n\t\treturn false;\n\t},\n\t\"change input[type='file']\" : function(event){\n\t\tvar selector = this.selector;\n\t\t\n\t\tif(!(selector && selector.collection && selector._id)){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar success = function(e) {\n\t\t\tvar image  = new Image();\n\t\t\timage.src = e.target.result;\n\t\t\tuploadImage(e.target.result, selector);\n\t\t};\n\n\t\tfor(var i = 0 ; i < event.target.files.length ; i ++ ){\n\t\t\tvar file = event.target.files[i];\n\t\t\tvar FR= new FileReader();\n\t\t\tFR.onloadend = success;\n\t\t\tFR.readAsDataURL(file);\n\t\t}\n\t\treturn true;\n\t}\n});\n\nfunction uploadImage(photo, selector){\n\tvar formData = new FormData();\n\tformData.append(\"directoryName\", \"images\");\n\tformData.append(\"_id\", selector._id);\n\tformData.append(\"collection\", selector.collection);\n\t\n\tif(!Meteor.status().connected){\n\t\tMeteor.call(\"pictureCreator\", photo, {\n\t\t\tcollection : formData.collection,\n\t\t\t_id : formData._id,\n\t\t});\n\t\t\n\t\treturn ;\n\t}\n\t\n\tMeteor.b64toBlob(photo, function success(blob) {\n\t\tformData.append(\"file[]\", blob);\n\t\t$.ajax({\n\t\t\turl: Meteor.pictureUploadServer,\n\t\t\ttype: \"POST\",\n\t\t\tdata: formData,\n\t\t\tcache: false,\n\t\t\tcontentType: false,\n\t\t\tprocessData: false\n\t\t})\n\t\t.fail(function(){\n\t\t\tMeteor.call(\"pictureCreator\", photo, {\n\t\t\t\tcollection : formData.collection,\n\t\t\t\t_id : formData._id,\n\t\t\t});\n\t\t});\n\t}, function error(err){\n\t\tif(err) throw new Meteor.Error(err);\n\t});\n}\n\n"]}