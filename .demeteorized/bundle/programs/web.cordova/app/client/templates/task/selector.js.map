{"version":3,"sources":["meteor://ðŸ’»app/client/templates/task/selector.js"],"names":[],"mappings":"yBAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,E","file":"/client/templates/task/selector.js","sourcesContent":["\"use strict\";\n/*global _ : false */\n/*global $ : false */\n/*global Tasks : false */\n/*global Meteor : false */\n/*global Session : false */\n/*global Template : false */\n/*global parseInt : false */\n\nvar getTasks = function(selected_ids){\n\treturn \t_\n\t\t\t.chain(Tasks.find({}).fetch())\n\t\t\t.groupBy(function(task){\n\t\t\t\treturn task.moduletype;\n\t\t\t})\n\t\t\t.map(function(tasks, group){\n\t\t\t\treturn {\n\t\t\t\t\tlabel : group||\"Sans catÃ©gorie\",\n\t\t\t\t\tchildren : \ttasks\n\t\t\t\t\t\t\t\t.map(function(task){\n\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\tselected : _.contains(selected_ids, task._id),\n\t\t\t\t\t\t\t\t\t\tlabel: task.name, \n\t\t\t\t\t\t\t\t\t\tvalue: task._id\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t})\n\t\t\t\t};\n\t\t\t\t\n\t\t\t})\n\t\t\t.sortBy(function(task){\n\t\t\t\treturn task.label;\n\t\t\t})\n\t\t\t.value();\n\n};\n\nTemplate.taskselector.rendered = function(){\n\tvar data = this.data;\n\t$(\"[multiple][data-key='\"+data.key+\"']\")\n\t.multiselect({\n\t\tbuttonWidth: \"100%\", \n\t\tincludeSelectAllOption: true,\n\t\tselectAllText : \"Toutes les tÃ¢ches\",\n\t\tbuttonText: function() {\n\t\t\treturn \"TÃ¢che pour ce module\";\n\t\t},\n\t\tonChange: function(){\n\t\t\tvar tasks = Session.get(Meteor.TASK_SELECTED);\n\t\t\ttasks[\"module_\"+data.key] = this.$select.val()||[];\n\t\t\tSession.set(Meteor.TASK_SELECTED, tasks);\n\t\t}\n\t})\n\t.multiselect(\"dataprovider\", getTasks(data.taskIds));\n};\n\nTemplate.taskselector.tasks = function(){\n\treturn\t_\n\t\t\t.chain(Session.get(Meteor.TASK_SELECTED))\n\t\t\t.map(function(taskIds, key){\n\t\t\t\treturn {\n\t\t\t\t\tmoduleKey : key.split(\"_\").pop(),\n\t\t\t\t\ttasks :\tTasks\n\t\t\t\t\t\t\t.find({\n\t\t\t\t\t\t\t\t_id : {\n\t\t\t\t\t\t\t\t\t$in : taskIds\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.fetch()\n\n\t\t\t\t};\n\t\t\t})\n\t\t\t.value();\n};"]}