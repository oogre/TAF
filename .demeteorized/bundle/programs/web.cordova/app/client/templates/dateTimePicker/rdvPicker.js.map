{"version":3,"sources":["meteor://ðŸ’»app/client/templates/dateTimePicker/rdvPicker.js"],"names":[],"mappings":"yBAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G","file":"/client/templates/dateTimePicker/rdvPicker.js","sourcesContent":["\"use strict\";\n/*global $ : false */\n/*global Meteor : false */\n/*global moment : false */\n/*global Session : false */\n/*global Template : false */\n\n\nTemplate.rdvPicker.date = function(template, next){\n\tvar deferred = new $.Deferred();\n\tvalidator(template, function(error, values){\n\t\tif(error) {\n\t\t\tdeferred.reject(error);\n\t\t\treturn next(error);\n\t\t}\n\t\tdeferred.resolve(values);\n\t\treturn next(null, values);\n\t});\n\treturn deferred;\n};\n\nvar validator = function(template, next){\n\tvar rendezvous = template.find(\"#rendezvous\");\n\tvar errors = template.find(\".rdvPicker .has-error\");\n\t\n\t$(errors)\n\t.removeClass(\"has-error\");\n\n\tvar validation = function(element){\n\t\tif(!element.value){\n\t\t\t$(element)\n\t\t\t.parents(\".form-group\")\n\t\t\t.first()\n\t\t\t.addClass(\"has-error\");\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\tif(rendezvous){\n\t\tif(\tvalidation(rendezvous)){\n\t\t\treturn next(new Meteor.Error(\"validation-error\"));\n\t\t}\n\t\treturn next(null, moment(rendezvous.value, rendezvous.getAttribute(\"data-date-format\")).hour(\"03\").toISOString());\n\t}else{\n\t\treturn next(null, null);\n\t}\n};\n\nTemplate.rdvPicker.rendered = function(){\n\tvar self = this;\n\tvar date = this.data.rdv || moment(Session.get(Meteor.CALENDAR_CONF).defaultDate).toISOString();\n\n\t$(\"#rendezvous\").datetimepicker({\n\t\ticons: {\n\t\t\ttime: \"fa fa-clock-o\",\n\t\t\tdate: \"fa fa-calendar\",\n\t\t\tup: \"fa fa-arrow-up\",\n\t\t\tdown: \"fa fa-arrow-down\"\n\t\t},\n\t\tlanguage : \"fr\",\n\t\tdefaultDate : moment(date)\n\t});\n\tif(this.data.rdv){\n\t\t$(\"#rendezvous\").on(\"dp.change\",function (event) {\n\t\t\tMeteor.call(\"workRdvUpadtor\", self.data.workId, event.date.toISOString());\n\t\t});\n\t}\n};\n\nTemplate.rdvPicker.helpers({\n\tdateFormat : function(){\n\t\tif(this.rdv) return \"dd-DD/MM/YY HH:mm\";\n\t\telse return \"dd-DD/MM/YY\";\t\n\t}\n});"]}