{"version":3,"sources":["meteor://ðŸ’»app/client/templates/worker/edit.js"],"names":[],"mappings":"yBAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"/client/templates/worker/edit.js","sourcesContent":["\"use strict\";\n/*global $ : false */\n/*global Meteor : false */\n/*global Session : false */\n/*global Accounts : false */\n/*global Template : false */\n\n\n\nTemplate.workeredit.rendered = function(){\n\n};\n\nTemplate.workeredit.helpers({\n\tcurrentUser : function(){\n\t\tSession.set(Meteor.CHANGE_PWD_KEY, false);\n\t\tif(Meteor.user())\n\t\t\treturn Meteor.user();\n\t\telse\n\t\t\treturn {};\n\t},\n\tchangepwd : function(){\n\t\treturn Session.get(Meteor.CHANGE_PWD_KEY);\n\t}\n});\n\nTemplate.workeredit.events({\n\t\"click .updateUser\" : function(event, template){\n\t\tvar savUser = template.find(\".updateUser\");\n\t\tvar errors = template.find(\":not(.pwd) .has-error\");\n\t\t\n\t\tvar _id = template.find(\"#_id\");\n\t\tvar firstname = template.find(\"#firstname\");\n\t\tvar lastname = template.find(\"#lastname\");\n\t\tvar role = $(\"#role\")[0];\n\t\tvar address_street = template.find(\"#address_street\");\n\t\tvar address_number = template.find(\"#address_number\");\n\t\tvar address_zipcode = template.find(\"#address_zipcode\");\n\t\tvar address_city = template.find(\"#address_city\");\n\t\tvar address_country = template.find(\"#address_country\");\n\t\tvar phone = template.find(\"#phone\");\n\n\t\t$(errors)\n\t\t.removeClass(\"has-error\");\n\n\t\tvar validation = function(element){\n\t\t\tif(!element.value){\n\t\t\t\t$(element)\n\t\t\t\t.parent()\n\t\t\t\t.addClass(\"has-error\");\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\n\t\tif(\tvalidation(firstname) || validation(lastname) ||validation(address_street) || validation(address_number) || validation(address_zipcode) || validation(address_city) || validation(address_country) || validation(phone)){\n\t\t\treturn false;\n\t\t}\n\n\t\tMeteor.call(\"workerUpdator\", _id.value, {\n\t\t\tfirstname : firstname.value.toLowerCase(),\n\t\t\tlastname : lastname.value.toLowerCase(),\n\t\t\taddress : {\n\t\t\t\tstreet : address_street.value.toLowerCase(),\n\t\t\t\tnumber : address_number.value.toLowerCase(),\n\t\t\t\tzipcode : address_zipcode.value.toLowerCase(),\n\t\t\t\tcity : address_city.value.toLowerCase(),\n\t\t\t\tcountry : address_country.value.toLowerCase()\n\t\t\t},\n\t\t\trole : parseInt(role.value),\n\t\t\tphone : phone.value.toLowerCase()\n\t\t}, function(error){\n\t\t\tif(error){\n\t\t\t\tconsole.log(error);\n\t\t\t}\n\t\t\telse{\n\t\t\t\t$(savUser)\n\t\t\t\t.removeClass(\"btn-primary\")\n\t\t\t\t.addClass(\"btn-success\");\n\t\t\t}\n\t\t});\n\n\t\treturn false;\n\t},\n\t\"click .changepwd\": function () {\n\t\tSession.set(Meteor.CHANGE_PWD_KEY, !Session.get(Meteor.CHANGE_PWD_KEY));\n\t\treturn false;\n\t},\n\n\t\"click .savepwd\": function (event, template) {\n\t\tvar oldPwd = template.find(\"#old_pwd\");\n\t\tvar newPwd = template.find(\"#new_pwd\");\n\t\tvar rePwd = template.find(\"#re_pwd\");\n\t\tvar savPwd = template.find(\".savepwd\");\n\t\tvar errors = template.find(\".pwd .has-error\");\n\t\t\n\t\t$(errors)\n\t\t.removeClass(\"has-error\");\n\t\t\n\t\tif(!oldPwd.value){\n\t\t\t$(oldPwd)\n\t\t\t.parent()\n\t\t\t.addClass(\"has-error\");\n\t\t\treturn false;\n\t\t}\n\t\tif(!newPwd.value){\n\t\t\t$(newPwd)\n\t\t\t.parent()\n\t\t\t.addClass(\"has-error\");\n\t\t\treturn false;\n\t\t}\n\t\tif(rePwd.value !== newPwd.value){\n\t\t\t$(rePwd)\n\t\t\t.parent()\n\t\t\t.addClass(\"has-error\");\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tAccounts.changePassword(oldPwd.value, newPwd.value, function(error) {\n\t\t\tif(error){\n\t\t\t\t$(oldPwd)\n\t\t\t\t.parent()\n\t\t\t\t.addClass(\"has-error\");\n\t\t\t}\n\t\t\telse{\n\t\t\t\t$(savPwd)\n\t\t\t\t.removeClass(\"btn-primary\")\n\t\t\t\t.addClass(\"btn-success\");\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\tSession.set(Meteor.CHANGE_PWD_KEY, false);\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t});\n\t\treturn false;\n\t},\n\n\t\n});\n"]}