{"version":3,"sources":["meteor://ðŸ’»app/client/templates/matter/form.js"],"names":[],"mappings":"yBAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"/client/templates/matter/form.js","sourcesContent":["\"use strict\";\n/*global _ : false */\n/*global $ : false */\n/*global Units : false */\n/*global Router : false */\n/*global Meteor : false */\n/*global Modules : false */\n/*global Template : false */\n\nTemplate.matterform.helpers({\n\tunits : function(){\n\t\tvar self = this;\n\t\tvar units = Units.find().fetch().map(function(unit){\n\t\t\tunit.selected = (self && self.matter && self.matter.unit === unit.shortname);\n\t\t\treturn unit;\n\t\t});\n\t\treturn units;\n\t},\n\tmoduletypes : function(){\n\t\tvar self = this;\n\t\treturn \t_\n\t\t\t\t.chain(Modules.find().fetch())\n\t\t\t\t.groupBy(function(module){ \n\t\t\t\t\treturn module.type;\n\t\t\t\t})\n\t\t\t\t.keys()\n\t\t\t\t.map(function(moduletype){\n\t\t\t\t\treturn {\n\t\t\t\t\t\tmoduletype : moduletype,\n\t\t\t\t\t\tselected : self.matter && self.matter.moduletype === moduletype\n\t\t\t\t\t};\n\t\t\t\t})\n\t\t\t\t.sortBy(function(module){\n\t\t\t\t\treturn module.moduletype;\n\t\t\t\t})\n\t\t\t\t.value();\n\t}\n});\nTemplate.matterform.events({\n\t\"click button[type='submit']\" : function(event, template){\n\t\tvar button = template.find(\"button[type='submit']\");\n\t\tvar errors = template.find(\".has-error\");\n\t\tvar _id = template.find(\"#_id\");\n\t\tvar name = template.find(\"#name\");\n\t\tvar unit = template.find(\"#unti\");\n\t\t\n\t\t$(errors)\n\t\t.removeClass(\"has-error\");\n\n\t\tvar validation = function(element){\n\t\t\tif(!element.value){\n\t\t\t\t$(element)\n\t\t\t\t.parent()\n\t\t\t\t.addClass(\"has-error\");\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\t\n\t\tif( validation(name)){\n\t\t\treturn false;\n\t\t}\n\t\tvar data = {\n\t\t\tname : name.value.toLowerCase(),\n\t\t\tunit : unit.value,\n\t\t};\n\t\tvar next = function(error){\n\t\t\tif(error){\n\t\t\t\tconsole.log(error);\n\t\t\t}\n\t\t\telse{\n\t\t\t\t$(button)\n\t\t\t\t.removeClass(\"btn-primary\")\n\t\t\t\t.addClass(\"btn-success\");\n\t\t\t\tRouter.go(\"matter.index\");\n\t\t\t}\n\t\t};\n\n\t\tif(_id.value){\n\t\t\tMeteor.call(\"matterUpdator\", _id.value, data, \"button[type='submit']\", next);\n\t\t}else{\n\t\t\tMeteor.call(\"matterCreator\", data, \"button[type='submit']\", next);\t\n\t\t}\n\t\t\n\n\t\treturn false;\n\t}\n});\n"]}